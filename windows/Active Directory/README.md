# Перенос пользователей и групп из одного домена в другой

Процесс миграции пользователей и групп из старого домена (например, `example.com`) в новый домен (например, `example.ru`) с использованием данных из бэкапа **Veem Explorer for Microsoft AD**.

## Описание

В этом проекте реализован процесс переноса данных из старого домена в новый с помощью **PowerShell**, **Bash** и **VBA** скриптов, включая преобразование бэкапов из формата `*.ldf` в удобочитаемый формат `CSV` и дальнейший импорт пользователей и групп в новый домен.

### Важные шаги:
1. **Экспорт данных из Veem Explorer** — создаём бэкап пользователей и групп в формате `*.ldf`.
2. **Декодирование данных** из base64 для подготовки к импорту.
3. **Получение групп** и **импорт подразделений** в каталог AD.
4. **Импорт пользователей** в соответствующие группы и подразделения нового домена.

## Скрипты

**Code.py** — Декодирование файла из base64

Скрипт для декодирования файла импорта из формата `base64` в читаемый формат.

```bash
python3 Code.py 
```
получение файла  csv 

```bash
export_ldf_to_csv.ps1 
```

CSV приводим в читаемый вид 

**import_otdel.ps1** импорт  подразделений в каталог AD 
```bash
import_otdel.ps1 
```
**get group.ps1** получение  групп  из файла 
```bash
get group.ps1 
```
**import_users.ps1**  импорт сотрудников в подразделения 
```bash
import_users.ps1
```


---

### Что включает README:
1. **Описание**: Объяснение, как происходит перенос пользователей и групп.
2. **Скрипты**: Подробности о каждом скрипте, как его использовать.
3. **Инструкция по запуску**: Пошаговая инструкция для пользователя.
4. **Зависимости**: Указаны зависимости, которые требуются для работы.
5. **Шилды**: Использование шильдов для PowerShell, Bash и VBA для визуального улучшения README.



референс 
https://www.alitajran.com/create-active-directory-users-from-csv-with-powershell/

